# Ara98biomass
Source code for "Linking frequency-dependent selection and overyielding through genome-wide association study of plant neighborhood effects" by Y. Sato.

## geno

- call_method_75_TAIR9_250k.csv.gz  
RegMap genotype data downloaded from https://bergelsonlab.org/resources/a-thaliana/#regmap

- subsetSNP.py
- gwasIDlist.csv
- reshapeSNP.R  
Python and R scripts to prepare input files for the imputed genotype data ```SEW2022_sub_snpsMAF5.rds``` and ```SEW_sub_posMAF5.rds```.  

  
- SEW2022_sub_snpsMAF5.rds  
- SEW_sub_posMAF5.rds  
Imputed genotype data subsetted for this study  
  

- chr1_ann.csv.gz
- chr2_ann.csv.gz
- chr3_ann.csv.gz
- chr4_ann.csv.gz
- chr5_ann.csv.gz  
Ancestral and derived SNP annotations required for selection scan. 
Scripts to generate these input files are available at Zenodo (https://doi.org/10.5281/zenodo.7945317) through our previous work (Sato et al. 2024 Nat Commun).

## pheno

- competition.csv  
Raw phenotype data downloaded from Zedono (https://doi.org/10.5281/zenodo.2659734), originally generated by Wuest et al. (2022) PLoS Biology.


## script

- Wuest2022biomass.R
- Wuest2022flowering.R
- Wuest2022rosette.R  
R scripts for RegMap-based GWAS of three phenotypes, i.e., biomass, flowering, and rosette size.

- Wuest2022imp.R  
R script for the imputed genotype-based GWAS of the biomass phenotype

- Wuest2022figures.R
- coord.R  
R script and utility function to make figures

- permWuest2022.R
- run_Wuest_perm.sh  
R and shell script for permutation tests of the biomass phenotype

- rehh_Ath98_Wuest2022.R  
R script to perform EHH scan based on SNP annotations ```chrX_ann.csv.gz``` in ```./geno```.

- BetaScan.py  
Python script to perform the BETA scan, originally downloaded at https://github.com/ksiewert/BetaScan

- rehh2BetaScan.R  
R script to convert the intermediate files of EHH into BETA scan inputs

- RunBetaScan.sh  
A shell script to run BETA scan


## output

- NeiGWAS_Wuest_et_al_sim_all_biomassZ.rds
- NeiGWAS_Wuest_et_al_sim_all_floweringZ.rds
- NeiGWAS_Wuest_et_al_sim_all_rosetteZ.rds  
RegMap-based GWAS results of three phenotypes, i.e., biomass, flowering, and rosette size. Use ```readRDS()``` to load them into R.

- NeiGWAS_Wuest_et_al_sim_all_biomassZ_impMAF5.rds
Imputed genotype-based GWAS results of the biomass phenotype 

- p_perm.csv.gz  
List of p-values from permutation tests.

- scan_ihs98_chr1.csv.gz
- scan_ihs98_chr2.csv.gz
- scan_ihs98_chr3.csv.gz
- scan_ihs98_chr4.csv.gz
- scan_ihs98_chr5.csv.gz  
Results of EHH and iHS scan for each chromosome

- BetaScanChr1out.txt
- BetaScanChr2out.txt
- BetaScanChr3out.txt
- BetaScanChr4out.txt
- BetaScanChr5out.txt  
Results of BETA scan for each chromosome


